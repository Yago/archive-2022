(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7173],{57103:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/recursion-real-life-problem-solver",function(){return t(72414)}])},72414:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return d},meta:function(){return i}});var a=t(85893),r=t(11151),s=t(47439);let i={path:"/blog/recursion-real-life-problem-solver",title:"Recursion, Real Life Problem Solver",date:"2018-10-11T00:00:00.000Z",type:"post",description:"Currently, functional programming is maybe the most used paradigm in the JavaScript community. It was not always so, but since few years with the ES6+ language overhaul and some popular libraries like React, Lodash, Redux, etc, it became more and more usual to adopt it. I will not write here about how this paradigm is great in many ways, there are a lot of great articles about it. Anyway, in a functional world, recursion is a very obvious and powerful tool to have in our toolbox."},o=e=>{let{children:n}=e;return(0,a.jsx)(s.Z,{meta:i,children:n})};function l(e){let n={a:"a",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Small disclaimer"}),": ",(0,a.jsx)(n.a,{href:"https://davidwalsh.name/impostor-syndrome",children:"I’m an Impostor"})," and I’m not the nerdiest math engineer to speak about recursion which is such a heavy topic. Instead, ",(0,a.jsx)(n.strong,{children:"I will speak about my experience and how recursion can help solve “cleanly“ daily problems"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Currently, ",(0,a.jsx)(n.strong,{children:"functional programming is maybe the most used paradigm"})," in the JavaScript community. It was not always so, but since few years with the ES6+ language overhaul and some popular libraries like React, Lodash, Redux, etc, it became more and more usual to adopt it. I will not write here about how this paradigm is great in many ways, there are a lot of great articles about it. Anyway, ",(0,a.jsx)(n.strong,{children:"in a functional world, recursion is a very obvious and powerful tool to have in our toolbox."})]}),"\n",(0,a.jsx)(n.h2,{children:"Simple, but soooo complex"}),"\n",(0,a.jsx)(n.p,{children:"Yep."}),"\n",(0,a.jsx)(n.p,{children:"Few years ago, the first time I encounter a recursion it was with a more experienced dev colleague who gave me that solution to solve a particular situation that I had. I was like: “Great! but wait… what?!?”"}),"\n",(0,a.jsxs)(n.p,{children:["Basically, ",(0,a.jsx)(n.strong,{children:"recursive function is a function which calls itself"}),". That’s the simple definition, but if you want a deeper explanation, there is the ",(0,a.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Recursion_(computer_science)",children:"Wiki page"}),". Same disclaimer than before, I’m just a daily JavaScript developer, not a mathematician. So yes, ",(0,a.jsx)(n.strong,{children:"algorithms are mostly based on recursive methods, but that’s all I know about this topic"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"The problem with recursive functions is to be hable to understand them"}),". It’s a bit like loops, but only for the “and again! and again! and again! ….” part. So yes, you will quickly have a lot of ",(0,a.jsx)(n.code,{children:"console.log"})," everywhere, without understanding much more what you are doing."]}),"\n",(0,a.jsx)(n.h2,{children:"The magic recipe"}),"\n",(0,a.jsx)(n.p,{children:"To code a nice recursive function, you must pay attention to the following points if you don’t want to spend a lifetime in a try-fail loop:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.strong,{children:"recursion"})," (no shit): when the method will call itself."]}),"\n",(0,a.jsxs)(n.li,{children:["Proper ",(0,a.jsx)(n.strong,{children:"conditions"}),": to define when it returns things or not in order to prevent failure."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Pureness"}),": first and second rule of the functional programming club"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For example,  if you want to get the index of a specific array value:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const numbers = [1,2,3,4];\n\nconst indexOf = (value, array, i = 0) => {\n  // value, array and i exist only in this instance, so pure\n\n  // Condition 1: Found it !\n  if (array[i] === value) return i;\n\n  // Condition 2: Sorry nothing founded\n  if (undefined === array[i]) return;\n\n  // Recursion: Keep going\n  return indexOf(value, array, i + 1);\n};\n\nconsole.log(indexOf(3, numbers)); // 2\nconsole.log(indexOf(5, numbers)); // undefined\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["Yes, I’m aware that ",(0,a.jsx)(n.code,{children:"numbers.indexOf(3)"})," is a faster an cleaner way to do it, not that a noob…"]})}),"\n",(0,a.jsx)(n.h2,{children:"Paginated API"}),"\n",(0,a.jsxs)(n.p,{children:["This first example is a recurring one. Very often, ",(0,a.jsx)(n.strong,{children:"when you want to call some data from an API, for some reason you want them all at once"}),". So you will fetch the first endpoint, get the data, call the next “page” and so on until there is no more “page” to fetch.  It’s very dangerous and stupid if there is a lot of “pages” and anything went wrong in the process, but that’s your call at the end \xaf_(ツ)_/\xaf"]}),"\n",(0,a.jsxs)(n.p,{children:["In this example, we will use ",(0,a.jsx)(n.a,{href:"https://swapi.co/",children:"SWAPI"})," to get all the universe’s species:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import axios from 'axios';\n\nconst swapiFetch = ({ url, payload = {}, resolver = null }) => {\n  return new Promise((resolve, reject) => {\n    axios\n      .get(url)\n      .then(res => {\n        const data = res.data;\n        const updatedPayload = [...payload, ...data.results];\n\n        if (data.next) {\n          swapiFetch({\n            url: data.next,\n            payload: updatedPayload,\n            resolver: resolver || resolve\n          });\n        } else {\n          if (resolver) resolver(updatedPayload);\n          resolve(updatedPayload);\n        }\n      })\n      .catch(err => {\n        console.error('error', err);\n      });\n  });\n};\n\nswapiFetch({ url: 'https://swapi.co/api/species/?format=json' })\n  .then(data => {\n    data.forEach(item => console.log(item.name));\n  });\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://codesandbox.io/s/0x06q4601l",children:"\uD83D\uDCE6 Play with the CodeSandbox example!"})}),"\n",(0,a.jsxs)(n.p,{children:["Because we are calling an asynchronous method through ",(0,a.jsx)(n.a,{href:"https://github.com/axios/axios",children:(0,a.jsx)(n.code,{children:"axios"})}),", we must use ",(0,a.jsx)(n.code,{children:"Promise"})," to solve this case. ",(0,a.jsx)(n.strong,{children:"So each time the method calls a new endpoint, it will add the response data to the payload and continue until there is no more endpoint to call."})," To resolve the initial Promise, we can pass the ",(0,a.jsx)(n.code,{children:"resolve"})," function as a argument. (Feel free to comment if you have a better way to do it). Even if it’s not the nicest way to do it, ",(0,a.jsx)(n.strong,{children:"it’s a good example of recursion and promises"}),"."]}),"\n",(0,a.jsx)(n.h2,{children:"Secret Santa"}),"\n",(0,a.jsx)(n.p,{children:"Each Christmas (not the most inclusive example I know), we are doing the secret Santa in my family. In order to not have to cut small pieces of paper, put them in a hat and draw yourself at the end, I directly code a small JS script to do it using text messages."}),"\n",(0,a.jsxs)(n.p,{children:["So basically ",(0,a.jsx)(n.strong,{children:"I have an array of peoples"})," with their names and phone number and ",(0,a.jsx)(n.strong,{children:"I must assign a name to each number"}),"  which is not itself.  I tried many approaches and the most recent one was to combine the famous The Fisher-Yates (aka Knuth) shuffle algorithm with a small validation method to check that no name was assigned to it own phone number."]}),"\n",(0,a.jsx)(n.p,{children:"Finally, it looks like:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"class SecretSanta {\n  /**\n   * Creates an instance of SecretSanta.\n   * @param {Array} array - array of people [{ name, phone },...]\n   */\n  constructor(array) {\n    this.array = array;\n  }\n\n  /**\n   * The Fisher-Yates (aka Knuth) shuffle algorithm\n   * http://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n   * inspired by Daplie/knuth-shuffle\n   * \n   * @param {Array} array - array to randomize\n   * @returns {Array} array randomized\n   */\n  knuth (array) {\n    let index = array.length;\n\n    // While there remain elements to shuffle...\n    while (0 !== index) {\n\n      // Pick a remaining element...\n      const randomIndex = Math.floor(Math.random() * index);\n      index -= 1;\n\n      // Swap it with the current element.\n      [array[index], array[randomIndex]] = [array[randomIndex], array[index]]\n    }\n\n    return array;\n  }\n\n\n  /**\n   * Validate permutation of randomized array\n   * \n   * @param {Array} a - reference array\n   * @param {Array} b - randomized array\n   * @param {string} key - comparison key (f.ex `name`)\n   * @returns {boolean}\n   */\n  validate (a, b, key) {\n    return !a.find((item, i) => item[key] === b[i][key]);\n  }\n\n\n  /**\n   * Build randomized assigned people array\n   * \n   * @returns {Array} \n   */\n  build () {\n    let randomized = this.knuth([...this.array]);\n\n    while (!this.validate(this.array, randomized, 'name')) {\n      randomized = this.knuth([...this.array])\n    }\n\n    const validated = this.array.map((person, i) => ({\n      from: person.name,\n      phone: person.phone,\n      to: randomized[i].name,\n    }));\n\n    return validated;\n  }\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["Full project on ",(0,a.jsx)(n.a,{href:"https://github.com/Yago/SecretSanta",children:"GitHub"}),"."]})}),"\n",(0,a.jsxs)(n.p,{children:["It’s not a single recursive function, but more a ",(0,a.jsxs)(n.strong,{children:["mix of multiple methods using mainly the ",(0,a.jsx)(n.code,{children:"while"})," operator"]}),". Remember, you can surely build complex recursive methods, but  I you want to understand it months or even years later, you better have to keep things simple and understandable."]}),"\n",(0,a.jsx)(n.h2,{children:"Deep Sanitizer"}),"\n",(0,a.jsxs)(n.p,{children:["Not longer than a week ago, I face some issue of retrieving unpredictable data out of a headless CMS through Gatsby GraphQL query language.  Because in this big data object I can only predict the parent attribute and not all the nested sub-attributes, ",(0,a.jsxs)(n.strong,{children:["my solution was to flag those parents and ",(0,a.jsx)(n.code,{children:"JSON.stringify"})," them with a recursive method."]})," They can be at any level, so I had to traverse the data response object, level by level, and stringify it when I found the right flag."]}),"\n",(0,a.jsx)(n.p,{children:"At the end, a simple traversing method, but not simple for me to write ^^’"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const object = {\n  first: 1,\n  second_toString: 2,\n  thirdy: [\n    {\n      a: \"foo\",\n      b_toString: 1\n    },\n    {\n      a: \"bar\"\n    }\n  ]\n};\n\n// ⚗️ Our magic machinery \uD83D\uDC47\nconst deepSanatizer = (obj, method) => {\n  // process Array\n  if (Array.isArray(obj)) {\n    return obj.map(item => deepSanatizer(item, method));\n  }\n\n  // process Object and look for attribute name match\n  if (typeof obj === 'object' && obj !== null) {\n    return Object.keys(obj).reduce((acc, key) => {\n      acc[key] = deepSanatizer(method(key, obj[key]), method);\n      return acc;\n    }, {});\n  }\n\n  return obj;\n};\n\nconst sanitizedObject = (object, (key, value) => {\n  if (key.includes('_toString')) return JSON.stringify(value);\n  return value;\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://codesandbox.io/s/wq9roy2xy7",children:"\uD83D\uDCE6 Play with the CodeSandbox example!"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"I still don’t run any performance tests to see if there are some less consuming approaches"}),", but it remains a good example of deep object traversing with recursion."]}),"\n",(0,a.jsx)(n.h2,{children:"Conclusion"}),"\n",(0,a.jsxs)(n.p,{children:["I’m sure everybody who uses recursion weekly has a lot of good examples. ",(0,a.jsx)(n.strong,{children:"I encourage you to share your proudest recursive functions and discuss them with the community"})," to be more efficient each time you have to write one."]}),"\n",(0,a.jsxs)(n.p,{children:["Honestly, it’s still hard and time consuming for me to write them. Maybe it’s because I’m not a proper engineer or maybe because it’s hard for everyone (reassure me please ^^’). Anyway, ",(0,a.jsx)(n.strong,{children:"it’s a very powerful way solve things and it will keep your code small and something, simple to read and to understand."})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"Supported with"})," \uD83D\uDC9B ",(0,a.jsxs)(n.em,{children:["by ",(0,a.jsx)(n.a,{href:"https://antistatique.net",children:"Antistatique"})]})]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(o,{...e,children:(0,a.jsx)(l,{...e})})}},62090:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var a=t(85893);t(67294);var r=t(90512),s=t(41664),i=t.n(s),o=t(68658),l=t(81612),d=e=>{let{crumbs:n}=e;return(0,a.jsx)("nav",{"aria-label":"breadcrumb",className:"mb-6 transform md:translate-x-1 md:mb-0",children:(0,a.jsxs)("ol",{className:"inline-flex text-sm text-gray-600 lowercase md:text-lg opacity-60 hover:opacity-100 duration-500 transition-opacity transform md:-translate-x-full md:translate-y-2 md:-rotate-90 md:origin-right",children:[(0,a.jsx)("li",{children:(0,a.jsxs)(i(),{href:"/",className:"link",children:[(0,a.jsx)("span",{className:"sr-only",children:"Homepage"}),(0,a.jsx)(l.Z,{name:"tipi",className:"text-base md:text-lg"})]})}),n.map((e,n)=>{let{href:t,label:s}=e;return(0,o.Z)(t)?(0,a.jsxs)("li",{"aria-current":"page",children:[(0,a.jsx)("span",{className:"px-3","aria-hidden":!0,children:"\xb7"}),(0,a.jsx)("span",{className:(0,r.Z)("inline-block truncate",{maxWidth:250}),children:s})]},"crumb-".concat(n)):(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"px-3","aria-hidden":!0,children:"\xb7"}),(0,a.jsx)(i(),{href:t,className:"link",children:s})]},"crumb-".concat(n))})]})})}},47439:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var a=t(85893);t(67294);var r=t(47906),s=t(63595),i=t(62090),o=t(73574),l=t(29454),d=t(53659),h=t(8523),c=t(35045),u=e=>{let{children:n,meta:t}=e;return(0,a.jsxs)(d.Z,{outsideChildren:(0,a.jsx)(h.Z,{}),children:[(0,a.jsx)(c.Z,{title:t.title,description:t.description}),(0,a.jsx)(i.Z,{crumbs:[{href:"/blog",label:"Blog"},{label:t.title}]}),(0,a.jsxs)("article",{className:"w-full mx-auto mt-20 sm:w-10/12 md:w-2/3 xl:w-7/12 md:px-8",children:[(0,a.jsxs)(l.Z,{move:!1,children:[(0,a.jsx)("h1",{className:"text-3xl font-medium text-gray-900 md:text-4xl lg:text-5xl",children:t.title}),(0,a.jsx)(o.Z,{children:(0,a.jsxs)("h2",{className:"font-medium md:text-lg",children:[(0,a.jsx)("span",{children:"Yann Gouffon — "}),(0,r.WU)((0,s.D)(t.date),"PPP")]})})]}),(0,a.jsx)(l.Z,{className:"mt-16 font-serif text-lg text-gray-900 space-y-6 md:mt-14 prose-headings:pt-4 prose-p:leading-[1.618em] lg:text-xl xl:text-2xl xl:prose-p:leading-[1.618em] prose-a:text-blue prose-headings:font-sans prose-headings:font-medium prose-h2:text-[26px] xl:prose-h2:text-[28px] prose-h3:text-[19px] lg:prose-h3:text-[24px] xl:prose-h3:text-[27px] prose-h4:text-[18px] lg:prose-h4:text-[21px] xl:prose-h4:text-[25px] prose-strong:text-medium prose-ul:list-disc prose-ul:pl-3 prose-ul:space-y-3 prose-ul:leading-[1.618em] xl:prose-figure:w-[106%] xl:prose-figure:-translate-x-[2.8%] prose-figure:rounded-lg prose-figure:overflow-hidden prose-figure:my-8",children:n})]})]})}}},function(e){e.O(0,[1635,9757,3880,520,5098,7539,8523,2888,9774,179],function(){return e(e.s=57103)}),_N_E=e.O()}]);