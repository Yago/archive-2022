(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{24598:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/beautiful-dem",function(){return s(47777)}])},47777:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return d},meta:function(){return a}});var n=s(85893),i=s(11151),l=s(47439),t=s(98727);let a={path:"/blog/beautiful-dem",title:"Beautiful DEM",date:"2013-06-24T17:22:29.000Z",type:"post",description:"Apr\xe8s avoir \xe9crit un article sur la cartographie web, j'ai voulu pousser plus loin la cr\xe9ation de cartes. Du coup, je me suis mis \xe0 TileMill et les portes du vaste monde du SIG open source se sont ouvertes devant moi. La cartographie web reste un domaine tr\xe8s technique et relativement peu accessible, mais une fois les premi\xe8res clefs obtenues, le reste vient de soi."},o=e=>{let{children:r}=e;return(0,n.jsx)(l.Z,{meta:a,children:r})};function c(e){let r={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.p,{children:["Apr\xe8s avoir \xe9crit un ",(0,n.jsx)(r.a,{href:"http://antistatique.net/blog/2013/04/05/devenez-un-maitre-cartographe/",children:"article"})," sur la cartographie web, j'ai voulu pousser plus loin la cr\xe9ation de cartes. Du coup, je me suis mis \xe0 ",(0,n.jsx)(r.a,{href:"http://www.mapbox.com/tilemill/",children:"TileMill"})," et les portes du vaste monde du SIG open source se sont ouvertes devant moi. La cartographie web reste un domaine tr\xe8s technique et relativement peu accessible, mais une fois les premi\xe8res clefs obtenues, le reste vient de soi."]}),"\n",(0,n.jsxs)(r.p,{children:["Apr\xe8s avoir vu une petite ",(0,n.jsx)(r.a,{href:"http://www.mapbox.com/blog/tilemill-raster-colorizer/",children:"d\xe9monstration"})," d'un d\xe9veloppeur de chez MapBox, j'ai cherch\xe9 \xe0 reproduire l'exemple sans utiliser la version de d\xe9veloppement de TileMill et en appliquant l'exp\xe9rimentation \xe0 notre belle Suisse."]}),"\n",(0,n.jsx)(r.h2,{children:"Trouver les donn\xe9es"}),"\n",(0,n.jsxs)(r.p,{children:["Le plus compliqu\xe9 dans cet exercice a \xe9t\xe9 de trouver des donn\xe9es DEM (digital elevation model) open source et avec une r\xe9solution suffisante \xe0 un niveau de zoom correct. Il se trouve que les USA sont tr\xe8s en avance en la mati\xe8re, mais l'Europe... Bref, j'ai fini par trouver ",(0,n.jsx)(r.a,{href:"http://www.viewfinderpanoramas.org/dem3.html",children:"un site"})," tr\xe8s bien qui en partage un certain nombre avec des qualit\xe9s variant de 1'' \xe0 15''."]}),"\n",(0,n.jsx)(r.h2,{children:"Traiter les donn\xe9es"}),"\n",(0,n.jsxs)(r.p,{children:["Ce que vous allez t\xe9l\xe9charger en fichier .dem ou .hgt sont des donn\xe9es brutes qu'il faudra transformer en images utilisables dans TileMill ou Mapnik. Pour cela, il existe une librairie libre permettant de traiter les images g\xe9ographiques : ",(0,n.jsx)(r.a,{href:"http://www.gdal.org/index.html",children:"Gdal"}),". Pour les utilisateurs de Mac, rendez-vous sur ",(0,n.jsx)(r.a,{href:"http://www.kyngchaos.com/software:frameworks",children:"kyngchaos.com"})," pour obtenir un framework pr\xeat \xe0 l'emploi de la librairie et de ses d\xe9pendances."]}),"\n",(0,n.jsx)(r.p,{children:"Apr\xe8s avoir install\xe9 la librairie, veillez \xe0 ne pas oublier de configurer le chemin dans le fichier de configuration de votre terminal :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"export PATH=/Library/Frameworks/GDAL.framework/Programs:$PATH\n"})}),"\n",(0,n.jsx)(r.p,{children:"Une fois install\xe9, il va vous falloir merger tous vos fichiers afin de garder un seul fichier DEM. Pour cela, ex\xe9cutez gdal-merge en sp\xe9cifiant le nom du fichier combin\xe9, suivi de tous les fichiers que vous souhaitez fusionner."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'$ gdal_merge.py -init "255" -o combined.dem file01.dem file02.dem file03.dem\n'})}),"\n",(0,n.jsx)(r.h2,{children:"Obtenir des GeoTIFF"}),"\n",(0,n.jsx)(r.p,{children:"Gdal, entre autres choses, permet de cr\xe9er des GeoTIFF utilisables dans TileMill ou Mapnik \xe0 partir d'un fichier DEM. Pour cet exemple nous aurons besoin de 3 images diff\xe9rentes."}),"\n",(0,n.jsx)(r.h3,{children:"Hillshade"}),"\n",(0,n.jsx)(r.p,{children:"L'image Hillshade permet d'appr\xe9hender au mieux un relief. Gr\xe2ce \xe0 ce mod\xe8le num\xe9rique de terrain r\xe9pondant aux conventions d'illumination, l'appr\xe9hension du relief de votre carte sera optimal. Pour cela :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"$ gdaldem hillshade -s 111120 combined.dem hillshade.tif\n"})}),"\n",(0,n.jsx)(t.Z,{alt:"gdal hillshade",filename:"alps-hillshade.jpg"}),"\n",(0,n.jsx)(r.h3,{children:"Color-relief"}),"\n",(0,n.jsxs)(r.p,{children:["Le color-relief vous permettra d'ajouter des couleurs \xe0 votre carte, d\xe9termin\xe9es par l'altitude. Pour cela, commencez par cr\xe9er un fichier ",(0,n.jsx)(r.strong,{children:"color.txt"})," dans lequel vous donnerez des couleurs rgb en fonction de l'altitude (ici 0m, 500m, 1000m, 2500m et 4000m)."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"0 71 68 62\n500 119 101 74 \n1000 85 107 50 \n2500 187 187 120 \n4000 217 222 170 \n"})}),"\n",(0,n.jsx)(r.p,{children:"Et dans le terminal :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"$ gdaldem color-relief combined.dem color.txt color.tif\n"})}),"\n",(0,n.jsx)(t.Z,{alt:"gdal color-relief",filename:"alps-color.jpg"}),"\n",(0,n.jsx)(r.h3,{children:"Slope"}),"\n",(0,n.jsxs)(r.p,{children:["Le slope est une image qui va mettre en valeur le relief d'une fa\xe7on diff\xe9rente de l'image hillshade, mais qui va apporter une grosse plus value \xe0 votre carte finale. Comme pour color-relief, cr\xe9ez un fichier ",(0,n.jsx)(r.strong,{children:"color_slope.txt"}),", indiquant cette fois la coloration en fonction de la pente (entre 0 et 90\xb0)."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"0 255 255 255\n90 0 0 0\n"})}),"\n",(0,n.jsx)(r.p,{children:"Et dans votre console :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"$ gdaldem slope combined.dem preslope.tif -s 111120\n$ gdaldem color-relief preslope.tif color_slope.txt slope.tif\n"})}),"\n",(0,n.jsx)(t.Z,{alt:"gdal slope",filename:"alps-slope.jpg"}),"\n",(0,n.jsx)(r.h2,{children:"Finalisation"}),"\n",(0,n.jsx)(r.p,{children:"Ouvrez TileMill et ajoutez vos 3 nouveaux calques en choisissant le bon syst\xe8me de projection (probablement WGS84). Encore un petit peu de CartoCSS et votre carte sera pr\xeate ! Dans l'ordre d'empilement :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-css",children:".slope {\n  raster-opacity:0.4;\n  raster-scaling:lanczos;\n  raster-comp-op: grain-extract;\n}\n.hillshade {\n  raster-opacity:1;\n  raster-scaling:lanczos;\n  raster-comp-op: soft-light;\n}\n.color {\n  raster-opacity:1;\n  raster-scaling:lanczos;\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Le r\xe9sultat"})," : ",(0,n.jsx)(r.a,{href:"https://geolab.app/labs/swissdem/",children:"geolab.io/swissdem.html"})]}),"\n",(0,n.jsx)(r.h2,{children:"Conclusion"}),"\n",(0,n.jsx)(r.p,{children:"\xc0 partir de cette petite d\xe9mo, on saisit rapidement l'\xe9tendue des possibilit\xe9s offertes, pouvant ainsi cr\xe9er toutes sortes de fonds pour nos cartes web. Vous voici entr\xe9 dans la cour des grands !"})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(o,{...e,children:(0,n.jsx)(c,{...e})})}},62090:function(e,r,s){"use strict";s.d(r,{Z:function(){return c}});var n=s(85893);s(67294);var i=s(90512),l=s(41664),t=s.n(l),a=s(68658),o=s(81612),c=e=>{let{crumbs:r}=e;return(0,n.jsx)("nav",{"aria-label":"breadcrumb",className:"mb-6 transform md:translate-x-1 md:mb-0",children:(0,n.jsxs)("ol",{className:"inline-flex text-sm text-gray-600 lowercase md:text-lg opacity-60 hover:opacity-100 duration-500 transition-opacity transform md:-translate-x-full md:translate-y-2 md:-rotate-90 md:origin-right",children:[(0,n.jsx)("li",{children:(0,n.jsxs)(t(),{href:"/",className:"link",children:[(0,n.jsx)("span",{className:"sr-only",children:"Homepage"}),(0,n.jsx)(o.Z,{name:"tipi",className:"text-base md:text-lg"})]})}),r.map((e,r)=>{let{href:s,label:l}=e;return(0,a.Z)(s)?(0,n.jsxs)("li",{"aria-current":"page",children:[(0,n.jsx)("span",{className:"px-3","aria-hidden":!0,children:"\xb7"}),(0,n.jsx)("span",{className:(0,i.Z)("inline-block truncate",{maxWidth:250}),children:l})]},"crumb-".concat(r)):(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"px-3","aria-hidden":!0,children:"\xb7"}),(0,n.jsx)(t(),{href:s,className:"link",children:l})]},"crumb-".concat(r))})]})})}},98727:function(e,r,s){"use strict";s.d(r,{Z:function(){return p}});var n=s(85893),i=s(67294),l=s(9701),t=s(58354),a=s(90512),o=s(29260),c=s.n(o),d=s(68658),u=s(83758),p=e=>{let{filename:r,alt:s,className:o}=e,p=u.Z[r],[h,m]=(0,i.useState)(!1),{observe:x,width:f}=(0,l.ZP)({polyfill:t.do});return(0,n.jsx)("div",{ref:x,className:"picture ".concat(o," bg-gray-100"),children:(0,n.jsx)("div",{className:(0,a.Z)("opacity-0 transition-opacity duration-200",h&&"opacity-100"),children:(0,n.jsx)(c(),{src:p.msrc,alt:s,width:p.w,height:p.h,quality:65,sizes:(0,d.Z)(f)?"100vw":"".concat(Math.round(f),"px"),onLoad:e=>{e.target.srcset&&m(!0)}})})})}},47439:function(e,r,s){"use strict";s.d(r,{Z:function(){return p}});var n=s(85893);s(67294);var i=s(47906),l=s(63595),t=s(62090),a=s(73574),o=s(29454),c=s(53659),d=s(8523),u=s(35045),p=e=>{let{children:r,meta:s}=e;return(0,n.jsxs)(c.Z,{outsideChildren:(0,n.jsx)(d.Z,{}),children:[(0,n.jsx)(u.Z,{title:s.title,description:s.description}),(0,n.jsx)(t.Z,{crumbs:[{href:"/blog",label:"Blog"},{label:s.title}]}),(0,n.jsxs)("article",{className:"w-full mx-auto mt-20 sm:w-10/12 md:w-2/3 xl:w-7/12 md:px-8",children:[(0,n.jsxs)(o.Z,{move:!1,children:[(0,n.jsx)("h1",{className:"text-3xl font-medium text-gray-900 md:text-4xl lg:text-5xl",children:s.title}),(0,n.jsx)(a.Z,{children:(0,n.jsxs)("h2",{className:"font-medium md:text-lg",children:[(0,n.jsx)("span",{children:"Yann Gouffon — "}),(0,i.WU)((0,l.D)(s.date),"PPP")]})})]}),(0,n.jsx)(o.Z,{className:"mt-16 font-serif text-lg text-gray-900 space-y-6 md:mt-14 prose-headings:pt-4 prose-p:leading-[1.618em] lg:text-xl xl:text-2xl xl:prose-p:leading-[1.618em] prose-a:text-blue prose-headings:font-sans prose-headings:font-medium prose-h2:text-[26px] xl:prose-h2:text-[28px] prose-h3:text-[19px] lg:prose-h3:text-[24px] xl:prose-h3:text-[27px] prose-h4:text-[18px] lg:prose-h4:text-[21px] xl:prose-h4:text-[25px] prose-strong:text-medium prose-ul:list-disc prose-ul:pl-3 prose-ul:space-y-3 prose-ul:leading-[1.618em] xl:prose-figure:w-[106%] xl:prose-figure:-translate-x-[2.8%] prose-figure:rounded-lg prose-figure:overflow-hidden prose-figure:my-8",children:r})]})]})}}},function(e){e.O(0,[1635,9757,3880,520,2781,5098,7539,8523,2888,9774,179],function(){return e(e.s=24598)}),_N_E=e.O()}]);